<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Making the Mazda nicer to drive">
	
	<link rel="icon" type="image/x-icon" href="/favicon.ico" sizes="48x48"/>
	<link rel="shortcut icon" href="/favicon.ico"/>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
	<link rel="manifest" href="/site.webmanifest"/>

	<title>Mazda Mods V: Quality of Life</title>
	<!-- Bootstrap -->
	<link href="/css/bootstrap-4.4.1.css" rel="stylesheet">
	<link href="/css/util.css" rel="stylesheet">
	
	<style>
		figure > img {
			height: 280px;
			border: 3px solid #888;
		}

		figure {
			align-content: center;
			text-align: center;
			font-size: 1em;
			font-style: italic;
			color: #666;
		}
	</style>
</head>

<body>
	<div id="fullpage" onclick="this.style.display='none';" style="cursor:zoom-out" tabindex="-1" aria-hidden="true"></div>
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<a class="navbar-brand" href="/index.html">tobo.games</a>
      	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      	<span class="navbar-toggler-icon"></span>
      	</button>
      	<div class="collapse navbar-collapse" id="navbarSupportedContent">
        	<ul class="navbar-nav mr-auto">
				<li class="nav-item">
            		<a class="nav-link" href="/Blog/index.html">Blog</a>
          		</li>
				<!--
				<li class="nav-item">
            		<a class="nav-link" href="/portfolio.html">Portfolio</a>
          		</li>
				-->
          		<li class="nav-item dropdown">
            		<a class="nav-link dropdown-toggle" href="#" id="projectDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            		Projects
            		</a>
            		<div class="dropdown-menu" aria-labelledby="projectDropdown">
					  	<a class="dropdown-item" href="/Projects/index.html">Projects Home Page</a>
						<div class="dropdown-divider"></div>
					  	<a class="dropdown-item" href="/Projects/Personal/index.html">Game Dev - Personal</a>
					  	<a class="dropdown-item" href="/Projects/School/index.html">Game Dev - School</a>
						<a class="dropdown-item" href="/Projects/Engineering/index.html">Engineering</a>
            		</div>
          		</li>
				<li class="nav-item dropdown">
            		<a class="nav-link dropdown-toggle" href="#" id="contactDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            		Contact
            		</a>
            		<div class="dropdown-menu" aria-labelledby="contactDropdown">
					  	<a class="dropdown-item p-1" href="mailto:evandaveikis@gmail.com" aria-label="Email">
							<img src="/images/email-icon.svg" width="20" height="20" alt="Email icon">
							Send Email
						</a>
    					<a class="dropdown-item p-1" href="https://github.com/tobogganeer" target="_blank" rel="noopener" aria-label="GitHub">
							<img src="/images/github-mark.svg" width="20" height="20" alt="Github logo">
							GitHub Profile
						</a>
						<a class="dropdown-item p-1" href="https://itch.io/profile/tobogganeer" target="_blank" rel="noopener" aria-label="Itch.io">
							<img src="/images/itchio-logo-textless-black.svg" width="20" height="20" alt="Github logo">
							Itch.io Page
						</a>
            		</div>
          		</li>
				<li class="nav-item">
            		<a class="nav-link" href="/about.html">About</a>
          		</li>
				<li class="nav-item">
            		<a class="nav-link" href="/VVGamesLauncher.exe" role="button" download>Download Launcher</a>
          		</li>
        	</ul>
      	</div>
    </nav>
    <section>
      	<div class="jumbotron text-center mt-2 p-4">
        	<div class="container">
          		<div class="row justify-content-center">
            		<div class="col-12">
              			<h1 style="text-decoration: underline; font-size: 4em">Mazda Mods V: Quality of Life</h1>
						<p>November 2, 2025</p>
						<a href="/Blog/index.html"><button class="btn btn-primary btn-lg" type="button">Back to Blogs Â»</button></a>
            		</div>
          		</div>
			</div>
      	</div>
    </section>
    <section>
      	<div class="container">
        	<h2>Intro</h2>
			<p>We just had reading week, followed by Design Week. Over reading week I figured it was a good idea to do some work on the Mazda before winter comes and hits. I swapped over to my winter tires and gave her an oil change, but this blog is about the cool tech I've added!</p>
			
			<br>
			<h2>Heated Seats</h2>
			<p>The first thing I wanted was heated seats. I had seen videos of people installing kits, so I had one sitting around for a few months before I decided that now was the ideal time to install them.</p>
			
			<p>I started by removing the seats and ripping off the upholstery (carefully, following instructions from the shop manual):</p>
			
			<figure>
				<img src="Images/removingseats.jpg" style="height: 300px;" alt="Car seats sitting on bed">
				<img src="Images/strippedseats.jpg" style="height: 300px;" alt="Car seats with upholstery removed">
				<img src="Images/hogrings.jpg" style="height: 300px;" alt="Bunch of cut hog rings">
				<figcaption>I'll be a happy man if I never have to cut hog rings with snips again. Ugh.</figcaption>
			</figure>
			
			<p>It was a bit weird when I needed to take a trip to the store (for parts for a tank controller - story for another time):</p>
			
			<figure>
				<img src="Images/triptothestore.jpg" style="height: 300px;" alt="Frame of a seat installed in the car">
				<figcaption>Definitely not the safest in case of whiplash, but I survived</figcaption>
			</figure>
			
			<p>The heated seat kit I got came with 4 heating pads (butt and back), along with the buttons and a control module. When this model of Mazda 3 comes with factory heated seats, they put the buttons next to the cigarette lighter. So I decided to put mine there too.</p>
			
			<figure>
				<img src="Images/buttonmodel.jpg" style="height: 300px;" alt="3D model of button mount">
				<img src="Images/printedbuttonmount.jpg" style="height: 300px;" alt="Printed button mount">
				<figcaption>Designed and printed a piece to hold the buttons</figcaption>
			</figure>
			
			<figure>
				<img src="Images/installedbuttonmount.jpg" style="height: 300px;" alt="Buttons and mount installed in removed trim piece">
				<img src="Images/functionalbuttons.jpg" style="height: 300px;" alt="Piece hooked up and functional in car">
				<img src="Images/buttonsinstalled.jpg" style="height: 300px;" alt="Buttons installed in car fully">
				<figcaption>The 3D printed piece just slips in and sits nicely</figcaption>
			</figure>
			
			<p>That's about it for the seats. I had to hook them up to my fusebox (which meant removing all the interior again, joy), and I routed the wire around and stuffed it where it needed to go. I ended up with a pretty neat and tidy install, and the seats work great (a bit too well - even the lowest setting is pretty warm for me!)</p>
			
			<hr>
			<h2>Gear Sensor</h2>
			<p>I had the idea for a while of having a heads up display to show me my speed and gear - inspired by <a href="https://www.youtube.com/watch?v=hjuuoNBPwUE" target="_blank">this HUD</a> and <a href="https://www.youtube.com/watch?v=QixtxaAda18" target="_blank">this gear sensor</a>.</p>
			
			<p>My setup is a bit different from both. I have my wireless data network to get data to the HUD, and there isn't enough room by my gearshift lever to detect it in the same way - but I came up with something different.</p>
			
			<figure>
				<img src="Images/geartheory.jpg" style="height: 300px;" alt="Sketches of the gear detector">
				<img src="Images/gearrods.jpg" style="height: 300px;" alt="What the shift rods in the car look like">
				<figcaption>I sketched this before I even started on any mods - the idea just came to me really early</figcaption>
			</figure>
			
			<p>My shifter mechanism has two linkages to the transmission: one for left and right movement, and one for forwards and backwards. The front-to-back one has more travel, but both or just linear slides. I figured I could put a magnet onto the rod and, inspired by the video above, use hall effect sensors to see where they are at. And that's what I did.</p>
			
			<figure>
				<img src="Images/gearsensormodels.jpg" style="height: 300px;" alt="Model of the gear detector housings">
				<img src="Images/geardetectors.jpg" style="height: 300px;" alt="Assembled gear detectors">
				<img src="Images/geardetectorinstalled.jpg" style="height: 300px;" alt="Installed gear detectors">
				<figcaption>The mounts constrain the magnets to a track and have a sensor at each end</figcaption>
			</figure>
			
			<p>It's just 4 hall effect sensors read by an ESP32 and sent wirelessly to the rest of the car. It all took a bunch of iteration - changing thresholds in the code and at least 3 redesigns of the mounts (moving the sensors around). In the end it works pretty good.</p>
			
			<p>One of the goofier issues I ran into was the fact that the hall effect sensors take and send back 5V logic, but the ESP32's analog pins only accept up to 3.3V. I had interpreted a graph incorrect in the hall effect sensor datasheet, and thought the max voltage would be 3.3V. So I had to splice in this monstrosity:</p>
			
			<figure>
				<img src="Images/gearvoltagedropdown.jpg" style="height: 350px;" alt="Voltage divider spliced in with resistors">
				<figcaption>Did someone say voltage divider?</figcaption>
			</figure>
			
			<p>Yeah, I soldered in 8 resistors to drop each line to 3.3V. Yes, it works perfectly.</p>
			<p>With that, I could tell what gear I was in. So it was time to start on the HUD!</p>
			
			<hr>
			<h2>Heads Up Display (HUD)</h2>
			<p>I had the gear. I had the speed (from the CAN bus). I just needed to display it.</p>
			<p>Much like the <a href="https://www.youtube.com/watch?v=hjuuoNBPwUE" target="_blank">this HUD</a>, I decided to go with 7 segment displays. Back when I thought of this idea (before any mods even started), I ordered some 7 segment displays for this exact purpose. Luckily, I also got some <a href="https://www.analog.com/media/en/technical-documentation/data-sheets/max7219-max7221.pdf" target="_blank">MAX7219 LED Display Drivers</a>. These came in very handy, letting my control all 6 of my segments and also the brightness of my HUD.</p>
			
			<figure>
				<img src="Images/hudtest.jpg" style="height: 300px;" alt="7 segment displays controlled by a breadboard">
				<figcaption>Sanity check to make sure my modules and wiring were correct</figcaption>
			</figure>
			
			<p>After testing out my leds and MAX7219, I was pondering the best way to assemble the final thing and decided to just directly solder every wire to each pin.</p>
			
			<figure>
				<img src="Images/hudmax7219wired.jpg" style="height: 300px;" alt="Tons of wires soldered to the MAX7219 chip">
				<img src="Images/hud3dprint.jpg" style="height: 300px;" alt="Said mess of wires coming out of a 3D printed part">
				<figcaption>This took forever...</figcaption>
			</figure>
			
			<p>The MAX7219 is only wired to the two 3 digit displays and the ESP8266. No reason to use a protoboard or bread board. I got a $25 label maker which really helped me keep things in order. Some of the labels fell off, but only after I had them attached.</p>
			
			<p>The wires are directly soldered to the MAX7219, but the ends going to the ESP8266 have dupont connector ends crimped onto them. Just made it easy to install instead of soldering. I also obviously heatshrunk/heatshrinked the wires so they wouldn't touch each other and implode.</p>
			
			<p>The 3D printed case/enclosure is so simple that I'm not going to cover it :P</p>
			
			<figure>
				<img src="Images/hudpreinstall.jpg" style="height: 300px;" alt="Testing segments before install">
				<img src="Images/hudinstalled.jpg" style="height: 300px;" alt="Lining up HUD module on a dash piece before cutting">
				<figcaption>Double checking everything works, then lining it up to cut the dash</figcaption>
			</figure>
			
			<p>I had to take out the instrument cluster to get at this bit of dash I wanted to install on. Then I just lined it up, drilled a million holes and filed the hole smooth. Pass the wires and modules through and Bob's your uncle.</p>
			
			<p>At this stage I put a bunch of epoxy all the wiring and on the digit displays. I did <b>not</b> want any of these wires making their way lose because getting to the dash is a massive pain.</p>
			
			<p>On the code side of things, there is nothing remarkable. The MAX7219 is easy to interface with, and the only thing to keep in mind is you want to write all the characters upside down (since they are reflecting off the windshield). The entire source file is less than 100 lines of code, including the CarComms stuff to receive things wirelessly.</p>
			
			<p>One little quality of life thing: Since this is reflecting off the windshield, I want it to get dimmer at night (I'm not trying to blind myself and it has to be pretty bright in direct sunlight). I considered hooking up a light sensor and calibrating that and blah blah blah, but I figured a better approach would just be to check when the car's lights were on. If that was possible.</p>
			
			<p>I hooked up my laptop to the CAN data center and sniffed some packets. The car <em>did</em> tell you when the lights were on - not lights vs headlights, but either was fine for me. While I was at it I also found what the CAN IDs and values were for the doors being open (the IDs I found online were not correct). I eventually want my little info display (or maybe the HUD?) show what doors are open, and now I have that data.</p>
			
			<p>So now the module dims itself when the car's lights are on. Thanks MAX7219 for making this very easy (I should've used a larger resistor as my lights are a tad bright at night - but not distractingly).</p>
			
			<p>Here's a rough video of it in action.</p>
			
			<figure>
				<video controls height="350">
					<source src="Images/hudworking.mp4" type="video/mp4"/>
				</video>
				<figcaption>Speed in white, gear in blue. This is merging onto the 403.</figcaption>
			</figure>
			
			<hr>
			<h2>Audio Switcher</h2>
			<p>The end goal is to have a bunch of audio sources in the car (Bluetooth, the Carputer, AUX, IOS, USB-C). Since I'm just stealing the car's AUX input, I need a way to switch between my 5 sources.</p>
			
			<p>I've mentioned the audio switcher in previous devlogs, but my original plan was to hand solder it all on protoboard. This would've been a huge pain, and I was going to do it just because I didn't know how to design PCBs and it looked scary. But then I tried it anyways.</p>
			
			<figure>
				<img src="Images/audioswitcherdesign.png" style="height: 300px;" alt="Schematic of audio switcher PCB">
				<img src="Images/audioswitcherpcb.jpg" style="height: 300px;" alt="The PCB in the (metaphorical) flesh">
				<img src="Images/audioswitcherwired.jpg" style="height: 300px;" alt="PCB with all components soldered to it">
				<figcaption>First PCB, and it wasn't even that bad!</figcaption>
			</figure>
			
			<p>The switcher uses two <a href="https://www.ti.com/lit/ds/symlink/cd4052b.pdf" target="_blank">CD4052B</a> modules to multiplex the 5 audio inputs down to one output, which goes into the hijacked AUX input. The module for displaying the current audio source and switching it has been installed in the car for ages, blindly sending out its signal like a space probe long out of reach.</p>
			
			<figure>
				<img src="Images/audioswitcherinstalled.jpg" style="height: 350px;" alt="Audio switcher installed in car">
				<figcaption>Fits nicely above the airbag module. Note the Bluetooth module at the bottom of the image</figcaption>
			</figure>
			
			<hr>
			<h2>Teaser</h2>
			<figure>
				<img src="Images/compressor.jpg" style="height: 400px;" alt="Compressor installed in trunk">
				<figcaption>A compressor... what could that be for?</figcaption>
			</figure>
			
      	</div>
    </section>
    <hr>
    <footer class="text-center">
      	<div class="container">
        	<div class="row">
          		<div class="col-12">
            		<p class="mb-0">Evan Daveikis 2026</p>
			  		<small class="mt-0 pb-3 text-muted">Very clearly not a web designer but I'm trying to learn!</small>
          		</div>
        	</div>
      	</div>
    </footer>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="/js/jquery-3.4.1.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap-4.4.1.js"></script>
	<script src="/js/fullscreen-images.js"></script>
</body>
</html>